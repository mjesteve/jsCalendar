/*
 * jsCalendarYearMonth v0.1.3-beta
 */

function jsCalendarYearMonth(element,options){this._options=this._parseOptions(options);this._year=this._options.year||new Date().getFullYear();this._container=element;this._container.classList.add('jsCalendar-yearmonth');this._calendars=[];this._render()}
jsCalendarYearMonth.version='v0.1.3-beta';jsCalendarYearMonth.prototype._parseOptions=function(options){var defaultOptions={language:'en',zeroFill:!1,monthFormat:'month',dayFormat:'D',firstDayOfTheWeek:!1,navigator:!1,navigatorPosition:'both',onMonthRender:!1,onDayRender:!1,onDateRender:!1,year:new Date().getFullYear(),minYear:0,maxYear:0,themeClasses:[],yearNavigator:!0,yearNavigatorPosition:'both',navIcons:!1,fontawesomePrefix:'fa',extensions:[],selectedDates:[],renderHeader:null,customYearTitle:null,responsiveLayout:!0,monthsPerRow:4,onPrevYear:null,onNextYear:null,onYearChanged:null,onDateClick:null,};var parsedOptions=Object.assign({},defaultOptions,options);if(typeof parsedOptions.minYear!=='undefined'&&parsedOptions.minYear!=='0'&&parsedOptions.minYear!==0){if(!Number.isInteger(parsedOptions.minYear)||parsedOptions.minYear<0){parsedOptions.minYear=defaultOptions.minYear}else{if(parsedOptions.year<parsedOptions.minYear){parsedOptions.year=parsedOptions.minYear}}}else{parsedOptions.minYear=defaultOptions.minYear}
if(typeof parsedOptions.maxYear!=='undefined'&&parsedOptions.maxYear!=='0'&&parsedOptions.maxYear!==0){if(!Number.isInteger(parsedOptions.maxYear)||parsedOptions.maxYear<0){parsedOptions.maxYear=defaultOptions.maxYear}else{if(parsedOptions.year>parsedOptions.maxYear){parsedOptions.year=parsedOptions.maxYear}}}else{parsedOptions.maxYear=defaultOptions.maxYear}
if(!parsedOptions.responsiveLayout&&(typeof parsedOptions.monthsPerRow!=='number'||parsedOptions.monthsPerRow<1||parsedOptions.monthsPerRow>12||!Number.isInteger(parsedOptions.monthsPerRow))){console.warn(`Valor inválido para monthsPerRow (${parsedOptions.monthsPerRow}). Se usará el valor predeterminado de ${defaultOptions.monthsPerRow}.`);parsedOptions.monthsPerRow=defaultOptions.monthsPerRow}
return parsedOptions};jsCalendarYearMonth.prototype._render=function(){var wrapper=this._container;var header=this._renderHeader(this._options.onPrevYear?this._options.onPrevYear.bind(this):this._prevYear.bind(this),this._options.onNextYear?this._options.onNextYear.bind(this):this._nextYear.bind(this));wrapper.appendChild(header);this._updateButtonsNavYear();if(this._options.responsiveLayout){this._renderBodyResponsive()}else{this._renderBodyColsRow()}};jsCalendarYearMonth.prototype._renderBodyColsRow=function(){var wrapper=this._container;var rowContainer=document.createElement("div");rowContainer.className="year-row-container";wrapper.appendChild(rowContainer);this._minwidthmoth=0;for(var i=0;i<12;i++){if(i%this._options.monthsPerRow===0&&i!==0){rowContainer=document.createElement("div");rowContainer.className="year-row-container";wrapper.appendChild(rowContainer)}
var monthContainer=document.createElement("div");monthContainer.className="month-container";rowContainer.appendChild(monthContainer);var calendar=this._renderMonth(wrapper,monthContainer,i);this._calendars.push(calendar);if(i===0){this._minwidthmoth=calendar._elements.table.offsetWidth}}
var mpr=this._options.monthsPerRow;var mwpr=this._minwidthmoth;var rowContainers=wrapper.querySelectorAll('.year-row-container');rowContainers.forEach(function(rowContainer){rowContainer.style.setProperty('--months-per-row',mpr);rowContainer.style.setProperty('--min-width-month',mwpr)})};jsCalendarYearMonth.prototype._renderBodyResponsive=function(){var wrapper=this._container;for(var i=0;i<12;i++){var monthContainer=document.createElement("div");wrapper.appendChild(monthContainer);var calendar=this._renderMonth(wrapper,monthContainer,i);this._calendars.push(calendar)}};jsCalendarYearMonth.prototype._renderHeader=function(onPrevYear,onNextYear){var header;if(typeof this._options.renderHeader==='function'){header=this._options.renderHeader(this._year,onPrevYear,onNextYear)}else{header=document.createElement("div");header.className="year-header";var title=document.createElement('span');title.className="year-title";var txttitle=this._year;if(typeof this._options.customYearTitle==='function'){txttitle=this._options.customYearTitle(this._year)}
var prevNav;var nextNav;if(this._options.yearNavigator){if(typeof this._options.navIcons==='string'&&(this._options.navIcons==='fontawesome'||this._options.navIcons==='material')){prevNav=document.createElement('i');prevNav.className="year-nav iconbutton prev ";if(this._options.navIcons==='fontawesome'){prevNav.className+=this._options.fontawesomePrefix+' fa-angle-left'}else{prevNav.className+="material-icons";prevNav.textContent="chevron_left"}
prevNav.style.cursor='pointer'}else{prevNav=document.createElement("div");prevNav.className="year-nav textbutton prev"}
prevNav.onclick=onPrevYear}
if(this._options.yearNavigator){if(typeof this._options.navIcons==='string'&&(this._options.navIcons==='fontawesome'||this._options.navIcons==='material')){nextNav=document.createElement('i');nextNav.className="year-nav iconbutton next ";if(this._options.navIcons==='fontawesome'){nextNav.className+=this._options.fontawesomePrefix+' fa-angle-right'}else{nextNav.className+="material-icons";nextNav.textContent="chevron_right"}
nextNav.style.cursor='pointer'}else{nextNav=document.createElement("div");nextNav.className="year-nav textbutton next"}
nextNav.onclick=onNextYear}
title.textContent=txttitle;if(!this._options.yearNavigator){header.appendChild(title)}else{if(this._options.yearNavigatorPosition==='left'){header.appendChild(prevNav);header.appendChild(nextNav);header.appendChild(title)}else if(this._options.yearNavigatorPosition==='right'){header.appendChild(title);header.appendChild(prevNav);header.appendChild(nextNav)}else{header.appendChild(prevNav);header.appendChild(title);header.appendChild(nextNav)}}}
return header};jsCalendarYearMonth.prototype._renderMonth=function(wrapper,monthContainer,month){this._options.themeClasses.forEach(function(themeClass){monthContainer.classList.add(themeClass)});var calendar=jsCalendar.new(monthContainer,0,{language:this._options.language,zeroFill:this._options.zeroFill,monthFormat:this._options.monthFormat,dayFormat:this._options.dayFormat,firstDayOfTheWeek:!this._options.firstDayOfTheWeek?undefined:this._options.firstDayOfTheWeek,navigator:!1,onMonthRender:this._options.onMonthRender,onDayRender:this._options.onDayRender,onDateRender:this._options.onDateRender,});calendar.goto(new Date(this._year,month,1));var parent=this;calendar.onDateClick(function(event,date){if(typeof parent._options.onDateClick==='function'){parent._options.onDateClick(event,date)}
var event=new CustomEvent('onDateClick',{detail:{event:event,date:date}});wrapper.dispatchEvent(event)});this._applyExtensions(calendar);this._selectDatesForMonth(calendar,month+1);return calendar};jsCalendarYearMonth.prototype.updateYear=function(newYear){if(newYear>0&&this._year!==newYear&&(this._options.minYear===0||(this._options.minYear!==0&&newYear>=this._options.minYear))&&(this._options.maxYear===0||(this._options.maxYear!==0&&newYear<=this._options.maxYear))){const oldYear=this._year;this._year=newYear;var title=this._container.querySelector(".year-title");var txttitle=this._year;if(typeof this._options.customYearTitle==='function'){txttitle=this._options.customYearTitle(this._year)}
title.textContent=txttitle;for(var i=0;i<12;i++){this._calendars[i].goto(new Date(this._year,i,1));this._selectDatesForMonth(this._calendars[i],i+1)}
var event=new CustomEvent('onYearChanged',{detail:{newYear:this._year,oldYear:oldYear}});this._container.dispatchEvent(event);if(typeof this._options.onYearChanged==='function'){this._options.onYearChanged(this._year,oldYear)}}
this._updateButtonsNavYear()};jsCalendarYearMonth.prototype._updateButtonsNavYear=function(){if(!this._options.yearNavigator||(this._options.minYear===0&&this._options.maxYear===0)){return}
var navButtonPrev=this._container.getElementsByClassName('prev')[0];if(navButtonPrev!==undefined&&this._options.minYear!==0&&this._year<=this._options.minYear){navButtonPrev.setAttribute('disabled','')}else if(navButtonPrev){navButtonPrev.removeAttribute('disabled')}
var navButtonNext=this._container.getElementsByClassName('next')[0];if(navButtonNext!==undefined&&this._options.maxYear!==0&&this._year>=this._options.maxYear){navButtonNext.setAttribute('disabled','')}else if(navButtonNext){navButtonNext.removeAttribute('disabled')}};jsCalendarYearMonth.prototype._prevYear=function(){this.updateYear(this._year-1)};jsCalendarYearMonth.prototype._nextYear=function(){this.updateYear(this._year+1)};jsCalendarYearMonth.prototype._applyExtensions=function(calendar){if(this._options.extensions&&this._options.extensions.length>0){this._options.extensions.forEach(function(ext){if(typeof jsCalendar.ext==='function'){var originalUpdate=calendar._events.update;calendar._events.update=function(month){originalUpdate.call(calendar,month);jsCalendar.ext(ext).update(calendar,month)}}})}};jsCalendarYearMonth.prototype._selectDatesForMonth=function(calendar,month){var datesToSelect=this._options.selectedDates.filter(function(date){var selectedDate=new Date(date);return selectedDate.getFullYear()===this._year&&(selectedDate.getMonth()+1)===month},this);if(datesToSelect.length>0){var dateObjects=datesToSelect.map(function(date){return new Date(date)});calendar.select(dateObjects)}};jsCalendarYearMonth.prototype.updateSelectedDates=function(newSelectedDates){this._options.selectedDates=newSelectedDates;for(var i=0;i<12;i++){this._calendars[i].clearselect();this._selectDatesForMonth(this._calendars[i],i+1)}};jsCalendar.ext('custom-date-attribute',{update:function(instance,month){for(var i=month.days.length-1;i>=0;i--){var dayElement=instance._elements.bodyCols[i];var date=month.days[i];dayElement.setAttribute('date',jsCalendar.tools.dateToString(date,'YYYYMMDD',instance._options.language||'en'))}}});jsCalendar.ext('custom-weekend-today',{update:function(instance,month){var today=new Date();for(var i=month.days.length-1;i>=0;i--){var dayElement=instance._elements.bodyCols[i];if(month.days[i].getDay()===0||month.days[i].getDay()===6){dayElement.classList.add('jsCalendar-weekend-days')}
if(today!=null&&month.days[i].getFullYear()===today.getFullYear()&&month.days[i].getMonth()===today.getMonth()&&month.days[i].getDate()===today.getDate()){dayElement.classList.add('jsCalendar-today');today=null}}}})